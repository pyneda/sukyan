code: http_request_smuggling_te_te
title: HTTP Request Smuggling (TE.TE)
description:
  The application is vulnerable to HTTP request smuggling via obfuscated Transfer-Encoding
  headers. In this TE.TE variant, both front-end and back-end servers support chunked
  encoding but can be induced to disagree through obfuscation techniques such as
  whitespace, invalid suffixes, or malformed header values. An attacker can exploit
  this desynchronization to smuggle malicious requests, potentially bypassing security
  controls, poisoning caches, or hijacking other users' requests.
remediation:
  Configure all servers in the chain to strictly validate Transfer-Encoding headers.
  Reject requests with ambiguous or malformed Transfer-Encoding values. Normalize
  header values before processing. Use HTTP/2 end-to-end where possible. Consider
  using a web application firewall (WAF) with request smuggling detection capabilities.
  Ensure front-end and back-end servers are patched and configured consistently.
cwe: 444
severity: High
references:
  - https://portswigger.net/web-security/request-smuggling
  - https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn
  - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/15-Testing_for_HTTP_Incoming_Requests
  - https://cwe.mitre.org/data/definitions/444.html
